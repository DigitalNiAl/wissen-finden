<script>
async function main() {
    await setupCamera();
    video.play();

    // Warten bis Video wirklich Daten hat
    await new Promise(resolve => {
        const check = () => {
            if (video.videoWidth > 0 && video.videoHeight > 0) {
                resolve();
            } else {
                requestAnimationFrame(check);
            }
        };
        check();
    });

    // Canvas jetzt korrekt setzen
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const model = await handpose.load();
    console.log("Handpose stabil geladen");

    let wordX = canvas.width / 2;
    let wordY = canvas.height / 2;

    async function render() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        const predictions = await model.estimateHands(video);
        if (predictions.length > 0) {
            const [x, y] = predictions[0].landmarks[9];

            const scaleX = canvas.width / video.videoWidth;
            const scaleY = canvas.height / video.videoHeight;

            wordX = x * scaleX;
            wordY = y * scaleY;
        }

        ctx.fillStyle = "white";
        ctx.font = "bold 80px Arial";
        ctx.fillText("WISSEN", wordX - 100, wordY - 40);

        requestAnimationFrame(render);
    }

    render();
}

main();
</script>
